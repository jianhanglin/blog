---
layout: post
title: 字体提示
tags:
- font
- hinting
---
### 起因

我发现字体提示（Font Hinting）技术，是因为实际开发中遇到的一个问题。

当时我打算利用`QPlainTextEdit`实现一个简易代码编辑器，在调整Tab宽度时，我发现如何设置也不能将Tab宽度设为恰好4个空格的宽度，似乎真正的字符宽度不是像素的整数倍。这个问题一直纠结我很长时间，知道最近，我在网上搜索时，发现有人说：

> If you disable hinting, the same TTF fonts should deliver same widths.

在代码中尝试了一下禁用Hinting，果然，Tab宽度与4个空格变得恰好一致。

### 字体提示

这个帮倒忙的hinting到底是什么技术，Wiki上面的解释如下（截取首段翻译）：

> 字体渲染技术是一种利用数学指示来调整轮廓字体的显示效果，使得字体线条与光栅网格对齐的一种技术。

从定义上看似乎比较乱，要理清字体提示，首先需要明白轮廓字体以及字体光栅化。

### 轮廓字体

字体从来都是一个大学问，不论是字体的设计还是字体的显示。最简单的字体是点阵字体，但是这种字体对分辨率的适应能力很差。后来出现的TrueType字体、OpenType字体都属于轮廓字体，能够很好地实现设备无关的字体。轮廓字体使用三次样条曲线绘制字体，只规定字体的轮廓，并不去关心哪个像素需要显示。

### 字体光栅化

字体光栅化通常被称作字体渲染。轮廓字体规定了字体的外形，字体光栅化技术用来将轮廓字体通过特定分辨率的屏幕显示出来。在较低分辨率的屏幕上，如果处理不好会造成非常严重的后果，因为对于处在轮廓边缘上的像素，是否将其包括在字体线条中，会极大地影像显示效果。而且，将圆滑的样条曲线表示为一个个的像素，必然会增加锯齿效果。抗锯齿技术虽然可以解决这个问题，但是会导致问题看上去更加模糊。

### 字体提示

字体提示正是为了在低分辨率设备上显示轮廓字体用的。通过字体中的提示，渲染引擎可以调整字体中的线条，改变其位置或者宽度，使其与设备的像素对其，这样就免去了抗锯齿的需要。Windows中的ClearType技术就利用了这点。

![上：未启用字体提示；下：启用字体提示](http://upload.wikimedia.org/wikipedia/commons/0/05/Font-hinting-example.png)

Wiki中的这张图片说明了字体提示的效果，在低分辨率情况下，字体会显得更加清晰，更适合在屏幕上阅读。

总之，字体提示是为了使用低分辨率而生的，如果分辨率提高了，不使用字体提示同样可以获得很好的阅读体验。并且，字体提示可能会改变字符的尺寸，导致莫名其妙的对齐错误，因此，将字体提示禁用是值得提倡的。
